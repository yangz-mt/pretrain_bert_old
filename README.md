# Pre-train BERT

A training script depending only on PyTorch and apex.

## Prerequisite

1. Install python packages (generated by `pip freeze` command)
```
pip install -r requirements.txt
```

2. Install `apex`
```shell
cd apex
pip install -v --no-cache-dir --global-option="--pyprof" --global-option="--cpp_ext" --global-option="--cuda_ext" ./
```

## Usage
```shell
cd pretrain
chmod +x run_pretrain_ddp.sh
./run_pretrain_ddp.sh
```

### Parameters in run_pretrain_ddp.sh

- `num_gpus` (L16): set 1 to specify 1 GPU training
- `CUDA_VISIBLE_DEVICES` (L17): set GPU id to train on
- `--dtr` (L39): add this option to use DTR
